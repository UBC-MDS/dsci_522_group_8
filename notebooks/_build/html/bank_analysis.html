

<!DOCTYPE html>


<html lang="en" data-content_root="" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Bank Marketing Analysis &#8212; Bank Marketing Analysis</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=5b4479735964841361fd" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=5b4479735964841361fd" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=5b4479735964841361fd" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=5b4479735964841361fd" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" href="_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=5b4479735964841361fd" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=5b4479735964841361fd" />
  <script src="_static/vendor/fontawesome/6.1.2/js/all.min.js?digest=5b4479735964841361fd"></script>

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script src="_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'bank_analysis';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <div id="pst-scroll-pixel-helper"></div>

  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>
    Back to top
  </button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  

<a class="navbar-brand logo" href="#">
  
  
  
  
  
  
    <p class="title logo__title">Bank Marketing Analysis</p>
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1 current active">
                <a class="reference internal" href="#">
                    Bank Marketing Analysis
                </a>
            </li>
        </ul>
        
    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/bank_analysis.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Bank Marketing Analysis</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#summary">Summary</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#introduction">Introduction</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#background">Background</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#research-question">Research Question</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#methods">Methods</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#data">Data</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#analysis">Analysis</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#data-preprocessing">Data Preprocessing</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#model-selection-and-evaluation">Model Selection and Evaluation</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#model-comparison">Model Comparison</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#hyperparameter-optimization">Hyperparameter Optimization</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#recall-the-preferred-metric">Recall - The Preferred Metric</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#modeling-and-results">Modeling and Results</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exploratory-data-analysis">Exploratory Data Analysis</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#preprocessing">Preprocessing</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#model-selection">Model Selection</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id3">Hyperparameter Optimization</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#test-results-after-hyperparameter-optimization">Test results after hyperparameter optimization</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#discussions">Discussions</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#key-findings">Key Findings</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#reflection-on-expectations">Reflection on Expectations</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#impact-of-finding">Impact of Finding</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#future-improvements">Future Improvements</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#references">References</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="bank-marketing-analysis">
<h1>Bank Marketing Analysis<a class="headerlink" href="#bank-marketing-analysis" title="Permalink to this heading">#</a></h1>
<p>by Runtian Li, Rafe Chang, Sid Grover, Anu Banga</p>
<p><strong>Repo Link:</strong> <a class="github reference external" href="https://github.com/UBC-MDS/dsci_522_group_8.git">UBC-MDS/dsci_522_group_8.git</a></p>
<div class="cell tag_remove-input docutils container">
</div>
<section id="summary">
<h2>Summary<a class="headerlink" href="#summary" title="Permalink to this heading">#</a></h2>
<p>Here we build a model of balanced SVC to try to predict if a new client will subscribe to a term deposit. We tested five different classification models, including dummy classifier, unbalanced/balanced logistic regression, and unbalanced/balanced SVC, and chose the optimal model of balanced SVC based on how the model scored on the test data; the model has the highest test recall score of 0.82, which indicates that the model makes the least false negative predictions among all five models.</p>
<p>The balanced support vector machines model considers 13 different numerical/ categorical features of customers. After hyperparameter optimization, the model’s test accuracy increased from 0.82 to 0.875. The results were somewhat expected, given SVC’s known efficacy in classification tasks, particularly when there’s a clear margin of separation. The high recall score of 0.875 indicates that the model is particularly adept at identifying clients likely to subscribe, which was the primary goal. It’s noteworthy that such a high recall was achieved, as it suggests the model is highly sensitive to true positive cases.</p>
</section>
<section id="introduction">
<h2>Introduction<a class="headerlink" href="#introduction" title="Permalink to this heading">#</a></h2>
<section id="background">
<h3>Background<a class="headerlink" href="#background" title="Permalink to this heading">#</a></h3>
<p>The data set Bank Marketing was created by Sérgio Moro and Paulo Rita at the University Institute of Lisbon, and Paulo Cortez at the University of Minhom. It is sourced from the UCI Machine Learning Repository. Each row in this data set is an observation related to direct marketing campaigns (phone calls) of a Portuguese banking institution.</p>
</section>
<section id="research-question">
<h3>Research Question<a class="headerlink" href="#research-question" title="Permalink to this heading">#</a></h3>
<p>We are working on a binary classification model. The classification goal is to predict if the client will subscribe a term deposit: “yes” for will subscribe and “no” for won’t subscribe.</p>
</section>
</section>
<section id="methods">
<h2>Methods<a class="headerlink" href="#methods" title="Permalink to this heading">#</a></h2>
<section id="data">
<h3>Data<a class="headerlink" href="#data" title="Permalink to this heading">#</a></h3>
<p>The data is related with direct marketing campaigns of a Portuguese banking institution. The marketing campaigns were based on phone calls. Often, more than one contact to the same client was required, in order to access if the product (bank term deposit) would be (‘yes’) or not (‘no’) subscribed. The data set used in this project was created by Moro, S. and Rita, P. and Cortez, P <span id="id1">[<a class="reference internal" href="#id5" title="S. Moro, P. Rita, and P. Cortez. Bank marketing. UCI Machine Learning Repository, 2012. https://doi.org/10.24432/C5K306.">Moro <em>et al.</em>, 2012</a>]</span>.It was sourced from the UCI Machine Learning Repository <span id="id2">[<a class="reference internal" href="#id5" title="S. Moro, P. Rita, and P. Cortez. Bank marketing. UCI Machine Learning Repository, 2012. https://doi.org/10.24432/C5K306.">Moro <em>et al.</em>, 2012</a>]</span>. We will be using bank-full.csv with all examples and 17 inputs, ordered by date (older version of this dataset with less inputs).</p>
</section>
<section id="analysis">
<h3>Analysis<a class="headerlink" href="#analysis" title="Permalink to this heading">#</a></h3>
</section>
<section id="data-preprocessing">
<h3>Data Preprocessing<a class="headerlink" href="#data-preprocessing" title="Permalink to this heading">#</a></h3>
<p>Initially, we ensured our data was complete by dealing with missing values and removing unnecessary columns like “contact,” “day,” and “month.” This streamlined the dataset, making it ready for analysis. We used StandardScaler to standardize numerical features such as “age” and “balance” and applied one-hot encoding for categorical attributes, making the data compatible with different machine learning models.</p>
</section>
<section id="model-selection-and-evaluation">
<h3>Model Selection and Evaluation<a class="headerlink" href="#model-selection-and-evaluation" title="Permalink to this heading">#</a></h3>
<p>We used five models for classification, starting with a basic Dummy Classifier. Following models included Logistic Regression and Support Vector Classifier (SVC), each showing strengths in accuracy and recall. Notably, our balanced models—Balanced Logistic Regression and Balanced Support Vector Classifier (svc_bal)—performed best, especially in identifying clients likely to subscribe to a term deposit.</p>
</section>
<section id="model-comparison">
<h3>Model Comparison<a class="headerlink" href="#model-comparison" title="Permalink to this heading">#</a></h3>
<p>An extensive evaluation, considering accuracy, precision, recall, and F1 scores, highlighted the Balanced Support Vector Classifier (svc_bal) as the standout performer. This model excelled with high recall, crucial for identifying potential term deposit subscribers in our specific context.</p>
</section>
<section id="hyperparameter-optimization">
<h3>Hyperparameter Optimization<a class="headerlink" href="#hyperparameter-optimization" title="Permalink to this heading">#</a></h3>
<p>Optimizing model performance, especially for the Support Vector Classifier (SVC) using a reduced dataset, resulted in a final model with an impressive 86% accuracy and a notable recall of 87%. This optimization strategy enhances efficiency and fine-tunes the model for better results.</p>
</section>
<section id="recall-the-preferred-metric">
<h3>Recall - The Preferred Metric<a class="headerlink" href="#recall-the-preferred-metric" title="Permalink to this heading">#</a></h3>
<p>In our bank marketing dataset, we prioritize recall. Recall indicates the model’s ability to identify true positive cases—clients subscribing to a term deposit. In our context, missing a potential positive case is more significant than false positives, leading to potential losses and missed opportunities. Prioritizing recall ensures a finely tuned model capturing all potential clients interested in term deposits, aligning with our main goal.</p>
</section>
</section>
<section id="modeling-and-results">
<h2>Modeling and Results<a class="headerlink" href="#modeling-and-results" title="Permalink to this heading">#</a></h2>
<section id="exploratory-data-analysis">
<h3>Exploratory Data Analysis<a class="headerlink" href="#exploratory-data-analysis" title="Permalink to this heading">#</a></h3>
<figure class="align-default" id="numerical-features-distribution">
<a class="reference internal image-reference" href="_images/numerical_dist_by_feat.png"><img alt="_images/numerical_dist_by_feat.png" src="_images/numerical_dist_by_feat.png" style="width: 800px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 1 </span><span class="caption-text">Distribution of all the numerical features after feature selection</span><a class="headerlink" href="#numerical-features-distribution" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<figure class="align-default" id="categorical-features-distribution">
<a class="reference internal image-reference" href="_images/categorical_dist_by_feat.png"><img alt="_images/categorical_dist_by_feat.png" src="_images/categorical_dist_by_feat.png" style="width: 800px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 2 </span><span class="caption-text">Distribution of all the categorical features after feature selection</span><a class="headerlink" href="#categorical-features-distribution" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
</section>
<section id="preprocessing">
<h3>Preprocessing<a class="headerlink" href="#preprocessing" title="Permalink to this heading">#</a></h3>
<div class="alert alert-info">
<ul class="simple">
<li><p>Since there is no missing values in our dataset, we don’t need to do imputation or drop NAs.</p></li>
<li><p>We are going to drop “contact”, “day” and “month” column here since they are not helping us in identifying useful underlying pattern in the model.</p></li>
<li><p>We take “age”, “balance”, “duration”, “campaign”, “pdays”, “previous” as numerical features and we are doing StandardScaler transformation on them.</p></li>
<li><p>We take “job”, “marital”, “education”, “default”, “housing”, “loan”, “poutcome” as categorical features and we are doing one hot encoding on them. We dropped columns only if the categorical is binary.</p></li>
</ul>
</div><p>The transformed dataframe after doing <code class="docutils literal notranslate"><span class="pre">StandardScale</span></code> on numerical features and <code class="docutils literal notranslate"><span class="pre">OneHotEncoder</span></code> on categorical features is shown as below. The number of features after preprocessing is 32.</p>
<div class="cell tag_remove-input docutils container">
</div>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>age</th>
      <th>balance</th>
      <th>duration</th>
      <th>campaign</th>
      <th>pdays</th>
      <th>previous</th>
      <th>job_admin.</th>
      <th>job_blue-collar</th>
      <th>job_entrepreneur</th>
      <th>job_housemaid</th>
      <th>...</th>
      <th>education_secondary</th>
      <th>education_tertiary</th>
      <th>education_unknown</th>
      <th>default_yes</th>
      <th>housing_yes</th>
      <th>loan_yes</th>
      <th>poutcome_failure</th>
      <th>poutcome_other</th>
      <th>poutcome_success</th>
      <th>poutcome_unknown</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>-1.125848</td>
      <td>-0.525607</td>
      <td>-0.250585</td>
      <td>-0.568295</td>
      <td>-0.411533</td>
      <td>-0.245565</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1.136220</td>
      <td>-0.457253</td>
      <td>0.100475</td>
      <td>-0.245219</td>
      <td>-0.411533</td>
      <td>-0.245565</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1.324725</td>
      <td>0.405335</td>
      <td>0.266360</td>
      <td>-0.245219</td>
      <td>0.537396</td>
      <td>0.600341</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>-1.031595</td>
      <td>-0.457253</td>
      <td>-0.173429</td>
      <td>-0.245219</td>
      <td>-0.411533</td>
      <td>-0.245565</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>-1.031595</td>
      <td>-0.280868</td>
      <td>-0.586213</td>
      <td>0.077857</td>
      <td>-0.411533</td>
      <td>-0.245565</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>36163</th>
      <td>0.853461</td>
      <td>0.767775</td>
      <td>2.419011</td>
      <td>0.077857</td>
      <td>-0.411533</td>
      <td>-0.245565</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>36164</th>
      <td>-0.466078</td>
      <td>-0.245524</td>
      <td>0.385952</td>
      <td>-0.568295</td>
      <td>-0.411533</td>
      <td>-0.245565</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>36165</th>
      <td>0.193692</td>
      <td>0.764441</td>
      <td>0.058039</td>
      <td>-0.568295</td>
      <td>-0.411533</td>
      <td>-0.245565</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>36166</th>
      <td>1.324725</td>
      <td>2.405259</td>
      <td>-0.223580</td>
      <td>-0.245219</td>
      <td>-0.411533</td>
      <td>-0.245565</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>36167</th>
      <td>0.476450</td>
      <td>0.260959</td>
      <td>-0.663369</td>
      <td>0.400933</td>
      <td>-0.411533</td>
      <td>-0.245565</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
    </tr>
  </tbody>
</table>
<p>36168 rows × 32 columns</p>
</div></div></div>
</div>
</section>
<section id="model-selection">
<h3>Model Selection<a class="headerlink" href="#model-selection" title="Permalink to this heading">#</a></h3>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>scoring</th>
      <th>dummy</th>
      <th>dummy.1</th>
      <th>logreg</th>
      <th>logreg.1</th>
      <th>svc</th>
      <th>svc.1</th>
      <th>logreg_bal</th>
      <th>logreg_bal.1</th>
      <th>svc_bal</th>
      <th>svc_bal.1</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>NaN</td>
      <td>mean</td>
      <td>std</td>
      <td>mean</td>
      <td>std</td>
      <td>mean</td>
      <td>std</td>
      <td>mean</td>
      <td>std</td>
      <td>mean</td>
      <td>std</td>
    </tr>
    <tr>
      <th>1</th>
      <td>fit_time</td>
      <td>0.119</td>
      <td>0.014</td>
      <td>0.652</td>
      <td>0.038</td>
      <td>16.451</td>
      <td>1.298</td>
      <td>0.804</td>
      <td>0.067</td>
      <td>30.036</td>
      <td>1.635</td>
    </tr>
    <tr>
      <th>2</th>
      <td>score_time</td>
      <td>0.072</td>
      <td>0.013</td>
      <td>0.099</td>
      <td>0.013</td>
      <td>1.78</td>
      <td>0.076</td>
      <td>0.134</td>
      <td>0.007</td>
      <td>3.353</td>
      <td>0.167</td>
    </tr>
    <tr>
      <th>3</th>
      <td>test_accuracy</td>
      <td>0.883</td>
      <td>0.0</td>
      <td>0.9</td>
      <td>0.004</td>
      <td>0.899</td>
      <td>0.003</td>
      <td>0.829</td>
      <td>0.005</td>
      <td>0.814</td>
      <td>0.007</td>
    </tr>
    <tr>
      <th>4</th>
      <td>train_accuracy</td>
      <td>0.883</td>
      <td>0.0</td>
      <td>0.9</td>
      <td>0.0</td>
      <td>0.906</td>
      <td>0.0</td>
      <td>0.83</td>
      <td>0.001</td>
      <td>0.824</td>
      <td>0.001</td>
    </tr>
    <tr>
      <th>5</th>
      <td>test_precision</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.653</td>
      <td>0.041</td>
      <td>0.657</td>
      <td>0.035</td>
      <td>0.386</td>
      <td>0.007</td>
      <td>0.369</td>
      <td>0.011</td>
    </tr>
    <tr>
      <th>6</th>
      <td>train_precision</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.655</td>
      <td>0.003</td>
      <td>0.724</td>
      <td>0.004</td>
      <td>0.387</td>
      <td>0.001</td>
      <td>0.387</td>
      <td>0.001</td>
    </tr>
    <tr>
      <th>7</th>
      <td>test_recall</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.314</td>
      <td>0.022</td>
      <td>0.291</td>
      <td>0.016</td>
      <td>0.778</td>
      <td>0.013</td>
      <td>0.823</td>
      <td>0.016</td>
    </tr>
    <tr>
      <th>8</th>
      <td>train_recall</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.314</td>
      <td>0.004</td>
      <td>0.324</td>
      <td>0.004</td>
      <td>0.779</td>
      <td>0.001</td>
      <td>0.863</td>
      <td>0.004</td>
    </tr>
    <tr>
      <th>9</th>
      <td>test_f1</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.423</td>
      <td>0.025</td>
      <td>0.403</td>
      <td>0.016</td>
      <td>0.516</td>
      <td>0.007</td>
      <td>0.509</td>
      <td>0.013</td>
    </tr>
    <tr>
      <th>10</th>
      <td>train_f1</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.425</td>
      <td>0.004</td>
      <td>0.448</td>
      <td>0.004</td>
      <td>0.517</td>
      <td>0.001</td>
      <td>0.534</td>
      <td>0.001</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="alert alert-info">
<p><code class="docutils literal notranslate"><span class="pre">Dummy</span> <span class="pre">Classifier</span></code> has low accuracy and zero precision, recall, and F1 scores, indicating it never predicts the positive class (in this case the client subscribed a term deposit). This is expected as it always predicts the most frequent class.</p>
<p><code class="docutils literal notranslate"><span class="pre">logreg</span></code> shows improved accuracy over the dummy model. However, its recall is low, suggesting it misses a significant number of true positive cases. <code class="docutils literal notranslate"><span class="pre">svc</span></code> performed almost the same as logistic regression model among all metrics.</p>
<p><code class="docutils literal notranslate"><span class="pre">logreg_bal</span></code> and <code class="docutils literal notranslate"><span class="pre">svc_bal</span></code> have lower accuracy compared to their unbalanced counterparts but significantly higher recall. This indicates they are better at identifying positive cases but at the cost of making more false positive errors.</p>
<p>Given the context of our bank marketing data set, we aim to detect the clients who will subscribe a term deposit given the features. Missing a potential “yes” could be more costly than false positives, as it represents a lost opportunity for the sales team to transform this potential customer. Therefore, we chose <code class="docutils literal notranslate"><span class="pre">svc_bal</span></code> as the model has the highest <code class="docutils literal notranslate"><span class="pre">test_recall</span></code> score.</p>
</div><div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>train_accuracy</th>
      <th>test_accuracy</th>
      <th>train_precision</th>
      <th>test_precision</th>
      <th>train_recall</th>
      <th>test_recall</th>
      <th>train_f1</th>
      <th>test_f1</th>
      <th>fit_time</th>
      <th>score_time</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.82385</td>
      <td>0.815659</td>
      <td>0.386597</td>
      <td>0.369435</td>
      <td>0.861531</td>
      <td>0.816462</td>
      <td>0.533704</td>
      <td>0.508694</td>
      <td>59.114527</td>
      <td>102.086006</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="id3">
<h3>Hyperparameter Optimization<a class="headerlink" href="#id3" title="Permalink to this heading">#</a></h3>
<div class="alert alert-info">
<p>Optimizing hyperparameters in SVC with a smaller sample size of 10,000 instances is a strategy aimed at enhancing computational efficiency. This approach expedites the exploration of hyperparameter possibilities, aiding in the discovery of potential configurations. While the outcomes validate the concept, it’s crucial to recognize and manage the constraints stemming from the smaller dataset size when interpreting the results.</p>
</div><div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Creating a sample of 10000 observations</span>
<span class="n">sample_data</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">10000</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">123</span><span class="p">)</span>
<span class="n">train_df_sampled</span><span class="p">,</span> <span class="n">test_df_sampled</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">sample_data</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">123</span><span class="p">)</span>

<span class="n">X_train_sampled</span> <span class="o">=</span> <span class="n">train_df_sampled</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;target&quot;</span><span class="p">])</span>
<span class="n">X_test_sampled</span> <span class="o">=</span> <span class="n">test_df_sampled</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;target&quot;</span><span class="p">])</span>
<span class="n">y_train_sampled</span> <span class="o">=</span> <span class="n">train_df_sampled</span><span class="p">[</span><span class="s2">&quot;target&quot;</span><span class="p">]</span>
<span class="n">y_test_sampled</span> <span class="o">=</span> <span class="n">test_df_sampled</span><span class="p">[</span><span class="s2">&quot;target&quot;</span><span class="p">]</span>

<span class="c1"># Transformation on the sample training data</span>
<span class="n">sample_preprocessor</span> <span class="o">=</span> <span class="n">make_column_transformer</span><span class="p">(</span>
    <span class="p">(</span><span class="n">StandardScaler</span><span class="p">(),</span> <span class="n">numerical_features</span><span class="p">),</span>
    <span class="p">(</span><span class="n">OneHotEncoder</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="s2">&quot;if_binary&quot;</span><span class="p">),</span> <span class="n">categorical_features</span><span class="p">),</span>
    <span class="p">(</span><span class="s2">&quot;drop&quot;</span><span class="p">,</span> <span class="n">drop_features</span><span class="p">),</span>
<span class="p">)</span>

<span class="c1"># X_train_sampled_enc = pd.DataFrame(sample_preprocessor.fit_transform(X_train_sampled), index=X_train_sampled.index, columns=new_columns)</span>

<span class="n">svc_bal_sample</span> <span class="o">=</span> <span class="n">make_pipeline</span><span class="p">(</span><span class="n">sample_preprocessor</span><span class="p">,</span> <span class="n">SVC</span><span class="p">(</span><span class="n">random_state</span><span class="o">=</span><span class="mi">123</span><span class="p">,</span> <span class="n">class_weight</span><span class="o">=</span><span class="s2">&quot;balanced&quot;</span><span class="p">))</span>

<span class="n">param_dist</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;svc__C&#39;</span><span class="p">:</span> <span class="n">uniform</span><span class="p">(</span><span class="mf">0.1</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span>
    <span class="s1">&#39;svc__gamma&#39;</span><span class="p">:</span> <span class="n">uniform</span><span class="p">(</span><span class="mf">0.001</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">),</span>
    <span class="s1">&#39;svc__kernel&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;rbf&#39;</span><span class="p">,</span> <span class="s1">&#39;sigmoid&#39;</span><span class="p">,</span> <span class="s1">&#39;linear&#39;</span><span class="p">]</span>
<span class="p">}</span>

<span class="c1"># Perform RandomizedSearchCV for hyperparameter optimization</span>
<span class="n">random_search</span> <span class="o">=</span> <span class="n">RandomizedSearchCV</span><span class="p">(</span><span class="n">svc_bal_sample</span><span class="p">,</span> <span class="n">param_distributions</span><span class="o">=</span><span class="n">param_dist</span><span class="p">,</span> <span class="n">n_iter</span><span class="o">=</span><span class="mi">25</span><span class="p">,</span> <span class="n">cv</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">n_jobs</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">123</span><span class="p">)</span>
<span class="n">random_search</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train_sampled</span><span class="p">,</span> <span class="n">y_train_sampled</span><span class="p">)</span>

<span class="c1"># Best hyperparameters</span>
<span class="n">best_params_random</span> <span class="o">=</span> <span class="n">random_search</span><span class="o">.</span><span class="n">best_params_</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Best Hyperparameters (Randomized Search):&quot;</span><span class="p">,</span> <span class="n">best_params_random</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">6</span><span class="p">],</span> <span class="n">line</span> <span class="mi">2</span>
<span class="g g-Whitespace">      </span><span class="mi">1</span> <span class="c1"># Creating a sample of 10000 observations</span>
<span class="ne">----&gt; </span><span class="mi">2</span> <span class="n">sample_data</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">10000</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">123</span><span class="p">)</span>
<span class="g g-Whitespace">      </span><span class="mi">3</span> <span class="n">train_df_sampled</span><span class="p">,</span> <span class="n">test_df_sampled</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">sample_data</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">123</span><span class="p">)</span>
<span class="g g-Whitespace">      </span><span class="mi">5</span> <span class="n">X_train_sampled</span> <span class="o">=</span> <span class="n">train_df_sampled</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;target&quot;</span><span class="p">])</span>

<span class="ne">NameError</span>: name &#39;df&#39; is not defined
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">random_search</span><span class="o">.</span><span class="n">cv_results_</span><span class="p">)[</span>
    <span class="p">[</span>
        <span class="s2">&quot;mean_test_score&quot;</span><span class="p">,</span>
        <span class="s2">&quot;param_svc__gamma&quot;</span><span class="p">,</span>
        <span class="s2">&quot;param_svc__C&quot;</span><span class="p">,</span>
        <span class="s2">&quot;mean_fit_time&quot;</span><span class="p">,</span>
        <span class="s2">&quot;rank_test_score&quot;</span><span class="p">,</span>
    <span class="p">]</span>
<span class="p">]</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s2">&quot;rank_test_score&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">sort_index</span><span class="p">()</span><span class="o">.</span><span class="n">T</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>rank_test_score</th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
      <th>3</th>
      <th>3</th>
      <th>3</th>
      <th>7</th>
      <th>7</th>
      <th>9</th>
      <th>10</th>
      <th>...</th>
      <th>16</th>
      <th>17</th>
      <th>18</th>
      <th>19</th>
      <th>20</th>
      <th>21</th>
      <th>22</th>
      <th>23</th>
      <th>24</th>
      <th>25</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>mean_test_score</th>
      <td>0.831875</td>
      <td>0.82775</td>
      <td>0.8275</td>
      <td>0.8275</td>
      <td>0.8275</td>
      <td>0.8275</td>
      <td>0.827375</td>
      <td>0.827375</td>
      <td>0.825</td>
      <td>0.82125</td>
      <td>...</td>
      <td>0.819</td>
      <td>0.819</td>
      <td>0.818375</td>
      <td>0.76425</td>
      <td>0.742125</td>
      <td>0.73775</td>
      <td>0.732375</td>
      <td>0.730375</td>
      <td>0.71675</td>
      <td>0.714125</td>
    </tr>
    <tr>
      <th>param_svc__gamma</th>
      <td>0.099076</td>
      <td>0.008709</td>
      <td>0.044086</td>
      <td>0.073905</td>
      <td>0.069326</td>
      <td>0.018537</td>
      <td>0.072915</td>
      <td>0.012562</td>
      <td>0.067931</td>
      <td>0.054183</td>
      <td>...</td>
      <td>0.044342</td>
      <td>0.040804</td>
      <td>0.025367</td>
      <td>0.023826</td>
      <td>0.042702</td>
      <td>0.042721</td>
      <td>0.049303</td>
      <td>0.052176</td>
      <td>0.0776</td>
      <td>0.083634</td>
    </tr>
    <tr>
      <th>param_svc__C</th>
      <td>4.331065</td>
      <td>1.640822</td>
      <td>4.437012</td>
      <td>3.53178</td>
      <td>5.073088</td>
      <td>5.40062</td>
      <td>7.008849</td>
      <td>6.33953</td>
      <td>5.204223</td>
      <td>5.415514</td>
      <td>...</td>
      <td>2.927029</td>
      <td>0.696779</td>
      <td>7.736828</td>
      <td>3.717887</td>
      <td>3.141208</td>
      <td>3.677289</td>
      <td>2.604554</td>
      <td>7.034032</td>
      <td>9.979953</td>
      <td>1.306287</td>
    </tr>
    <tr>
      <th>mean_fit_time</th>
      <td>0.677113</td>
      <td>0.7783</td>
      <td>1.51885</td>
      <td>1.317613</td>
      <td>1.537338</td>
      <td>1.499696</td>
      <td>1.95118</td>
      <td>1.800268</td>
      <td>0.688293</td>
      <td>0.707351</td>
      <td>...</td>
      <td>0.756204</td>
      <td>0.655976</td>
      <td>0.770482</td>
      <td>0.46971</td>
      <td>0.565585</td>
      <td>0.652933</td>
      <td>0.59485</td>
      <td>0.525791</td>
      <td>0.603188</td>
      <td>0.615842</td>
    </tr>
  </tbody>
</table>
<p>4 rows × 25 columns</p>
</div></div></div>
</div>
</section>
<section id="test-results-after-hyperparameter-optimization">
<h3>Test results after hyperparameter optimization<a class="headerlink" href="#test-results-after-hyperparameter-optimization" title="Permalink to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Evaluate the best model on the test set</span>
<span class="n">best_model_random</span> <span class="o">=</span> <span class="n">random_search</span><span class="o">.</span><span class="n">best_estimator_</span>
<span class="n">accuracy_random</span> <span class="o">=</span> <span class="n">best_model_random</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Accuracy on Test Set:&quot;</span><span class="p">,</span> <span class="n">accuracy_random</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Accuracy on Test Set: 0.8613292049098751
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">predictions</span> <span class="o">=</span> <span class="n">best_model_random</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>

<span class="n">recall</span> <span class="o">=</span> <span class="n">recall_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">predictions</span><span class="p">,</span> <span class="n">pos_label</span><span class="o">=</span><span class="s1">&#39;yes&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Recall on Test Set:&quot;</span><span class="p">,</span> <span class="n">recall</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Recall on Test Set: 0.8751182592242195
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">results</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">random_search</span><span class="o">.</span><span class="n">cv_results_</span><span class="p">)</span>

<span class="n">scatter</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">results</span><span class="p">)</span><span class="o">.</span><span class="n">mark_circle</span><span class="p">()</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
    <span class="n">x</span><span class="o">=</span><span class="s1">&#39;param_svc__C:Q&#39;</span><span class="p">,</span>
    <span class="n">y</span><span class="o">=</span><span class="s1">&#39;param_svc__gamma:Q&#39;</span><span class="p">,</span>
    <span class="n">color</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">Color</span><span class="p">(</span><span class="s1">&#39;mean_test_score:Q&#39;</span><span class="p">,</span> 
                    <span class="n">scale</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">Scale</span><span class="p">(</span><span class="n">scheme</span><span class="o">=</span><span class="s1">&#39;viridis&#39;</span><span class="p">,</span> <span class="n">reverse</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
                   <span class="p">)</span>
<span class="p">)</span><span class="o">.</span><span class="n">properties</span><span class="p">(</span>
    <span class="n">width</span><span class="o">=</span><span class="mi">400</span><span class="p">,</span>
    <span class="n">height</span><span class="o">=</span><span class="mi">300</span><span class="p">,</span>
    <span class="n">title</span><span class="o">=</span><span class="s1">&#39;C and gamma vs. Mean Test Score&#39;</span>
<span class="p">)</span>

<span class="n">scatter</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
<style>
  #altair-viz-b41ee71375484ddba564c19686e6206a.vega-embed {
    width: 100%;
    display: flex;
  }

  #altair-viz-b41ee71375484ddba564c19686e6206a.vega-embed details,
  #altair-viz-b41ee71375484ddba564c19686e6206a.vega-embed details summary {
    position: relative;
  }
</style>
<div id="altair-viz-b41ee71375484ddba564c19686e6206a"></div>
<script type="text/javascript">
  var VEGA_DEBUG = (typeof VEGA_DEBUG == "undefined") ? {} : VEGA_DEBUG;
  (function(spec, embedOpt){
    let outputDiv = document.currentScript.previousElementSibling;
    if (outputDiv.id !== "altair-viz-b41ee71375484ddba564c19686e6206a") {
      outputDiv = document.getElementById("altair-viz-b41ee71375484ddba564c19686e6206a");
    }
    const paths = {
      "vega": "https://cdn.jsdelivr.net/npm/vega@5?noext",
      "vega-lib": "https://cdn.jsdelivr.net/npm/vega-lib?noext",
      "vega-lite": "https://cdn.jsdelivr.net/npm/vega-lite@5.15.1?noext",
      "vega-embed": "https://cdn.jsdelivr.net/npm/vega-embed@6?noext",
    };

    function maybeLoadScript(lib, version) {
      var key = `${lib.replace("-", "")}_version`;
      return (VEGA_DEBUG[key] == version) ?
        Promise.resolve(paths[lib]) :
        new Promise(function(resolve, reject) {
          var s = document.createElement('script');
          document.getElementsByTagName("head")[0].appendChild(s);
          s.async = true;
          s.onload = () => {
            VEGA_DEBUG[key] = version;
            return resolve(paths[lib]);
          };
          s.onerror = () => reject(`Error loading script: ${paths[lib]}`);
          s.src = paths[lib];
        });
    }

    function showError(err) {
      outputDiv.innerHTML = `<div class="error" style="color:red;">${err}</div>`;
      throw err;
    }

    function displayChart(vegaEmbed) {
      vegaEmbed(outputDiv, spec, embedOpt)
        .catch(err => showError(`Javascript Error: ${err.message}<br>This usually means there's a typo in your chart specification. See the javascript console for the full traceback.`));
    }

    if(typeof define === "function" && define.amd) {
      requirejs.config({paths});
      require(["vega-embed"], displayChart, err => showError(`Error loading script: ${err.message}`));
    } else {
      maybeLoadScript("vega", "5")
        .then(() => maybeLoadScript("vega-lite", "5.15.1"))
        .then(() => maybeLoadScript("vega-embed", "6"))
        .catch(showError)
        .then(() => displayChart(vegaEmbed));
    }
  })({"$schema": "https://vega.github.io/schema/vega/v5.json", "data": [{"name": "source_0", "values": [{"mean_test_score": 0.819125, "param_svc__C": 7.064691855978616, "param_svc__gamma": 0.02961393349503795}, {"mean_test_score": 0.827375, "param_svc__C": 7.008848550268617, "param_svc__gamma": 0.0729150310154773}, {"mean_test_score": 0.8318749999999999, "param_svc__C": 4.331064601244609, "param_svc__gamma": 0.09907641983846155}, {"mean_test_score": 0.8202499999999999, "param_svc__C": 5.8969429702261005, "param_svc__gamma": 0.014995076263038455}, {"mean_test_score": 0.8275, "param_svc__C": 3.5317801615086943, "param_svc__gamma": 0.07390497073840417}, {"mean_test_score": 0.819, "param_svc__C": 0.6967789660956835, "param_svc__gamma": 0.04080442553304314}, {"mean_test_score": 0.820875, "param_svc__C": 6.417920176870504, "param_svc__gamma": 0.04502571780640763}, {"mean_test_score": 0.8212499999999998, "param_svc__C": 5.415513738418383, "param_svc__gamma": 0.05418275870968661}, {"mean_test_score": 0.819625, "param_svc__C": 3.077804977404459, "param_svc__gamma": 0.05020847767923423}, {"mean_test_score": 0.7377499999999999, "param_svc__C": 3.677289188090218, "param_svc__gamma": 0.04272099480253377}, {"mean_test_score": 0.76425, "param_svc__C": 3.717886556223141, "param_svc__gamma": 0.023826323087895562}, {"mean_test_score": 0.71675, "param_svc__C": 9.979952865166672, "param_svc__gamma": 0.07759959501929949}, {"mean_test_score": 0.8275, "param_svc__C": 4.437011726795282, "param_svc__gamma": 0.044086276332964386}, {"mean_test_score": 0.82775, "param_svc__C": 1.6408224184684672, "param_svc__gamma": 0.008708648079828329}, {"mean_test_score": 0.7303749999999999, "param_svc__C": 7.034032436025143, "param_svc__gamma": 0.05217633752661696}, {"mean_test_score": 0.827375, "param_svc__C": 6.339529517921111, "param_svc__gamma": 0.012561839507929572}, {"mean_test_score": 0.8275, "param_svc__C": 5.073087863238618, "param_svc__gamma": 0.06932629134230998}, {"mean_test_score": 0.732375, "param_svc__C": 2.604553653965067, "param_svc__gamma": 0.04930342642627044}, {"mean_test_score": 0.819125, "param_svc__C": 2.428359299859786, "param_svc__gamma": 0.04468606627948174}, {"mean_test_score": 0.7141249999999999, "param_svc__C": 1.3062866599032374, "param_svc__gamma": 0.08363408005068333}, {"mean_test_score": 0.8190000000000002, "param_svc__C": 2.9270293433269856, "param_svc__gamma": 0.04434182392266678}, {"mean_test_score": 0.7421249999999999, "param_svc__C": 3.141207890271841, "param_svc__gamma": 0.04270222110247016}, {"mean_test_score": 0.825, "param_svc__C": 5.204223374780111, "param_svc__gamma": 0.06793137829622724}, {"mean_test_score": 0.8275, "param_svc__C": 5.400620111997607, "param_svc__gamma": 0.018537266077991565}, {"mean_test_score": 0.818375, "param_svc__C": 7.736828414433382, "param_svc__gamma": 0.025366637453687405}]}, {"name": "source_0_x_domain_param_svc__C", "values": [{"min": 0.6967789660956835, "max": 9.979952865166672}]}, {"name": "source_0_y_domain_param_svc__gamma", "values": [{"min": 0.008708648079828329, "max": 0.09907641983846155}]}, {"name": "source_0_color_domain_mean_test_score", "values": [{"min": 0.7141249999999999, "max": 0.8318749999999999}]}], "marks": [{"type": "symbol", "name": "marks", "from": {"data": "source_0"}, "encode": {"update": {"description": {"signal": "\"param_svc__C: \" + (format(datum[\"param_svc__C\"], \"\")) + \"; param_svc__gamma: \" + (format(datum[\"param_svc__gamma\"], \"\")) + \"; mean_test_score: \" + (format(datum[\"mean_test_score\"], \"\"))"}, "y": {"field": "param_svc__gamma", "scale": "y"}, "shape": {"value": "circle"}, "fill": {"field": "mean_test_score", "scale": "color"}, "opacity": {"value": 0.7}, "ariaRoleDescription": {"value": "circle"}, "x": {"field": "param_svc__C", "scale": "x"}}}, "style": ["circle"]}], "scales": [{"name": "x", "type": "linear", "domain": [{"signal": "(data(\"source_0_x_domain_param_svc__C\")[0] || {}).min"}, {"signal": "(data(\"source_0_x_domain_param_svc__C\")[0] || {}).max"}], "range": [0, {"signal": "width"}], "nice": true, "zero": true}, {"name": "y", "type": "linear", "domain": [{"signal": "(data(\"source_0_y_domain_param_svc__gamma\")[0] || {}).min"}, {"signal": "(data(\"source_0_y_domain_param_svc__gamma\")[0] || {}).max"}], "range": [{"signal": "height"}, 0], "zero": true, "nice": true}, {"name": "color", "type": "linear", "domain": [{"signal": "(data(\"source_0_color_domain_mean_test_score\")[0] || {}).min"}, {"signal": "(data(\"source_0_color_domain_mean_test_score\")[0] || {}).max"}], "range": {"scheme": "viridis"}, "interpolate": "hcl", "reverse": true, "zero": false}], "axes": [{"scale": "x", "domain": false, "ticks": false, "minExtent": 0, "grid": true, "zindex": 0, "tickCount": {"signal": "ceil(width/40)"}, "maxExtent": 0, "gridScale": "y", "labels": false, "aria": false, "orient": "bottom"}, {"scale": "y", "grid": true, "zindex": 0, "gridScale": "x", "tickCount": {"signal": "ceil(height/40)"}, "labels": false, "domain": false, "maxExtent": 0, "ticks": false, "orient": "left", "minExtent": 0, "aria": false}, {"scale": "x", "zindex": 0, "labelOverlap": true, "labelFlush": true, "grid": false, "orient": "bottom", "title": "param_svc__C", "tickCount": {"signal": "ceil(width/40)"}}, {"scale": "y", "title": "param_svc__gamma", "zindex": 0, "orient": "left", "grid": false, "tickCount": {"signal": "ceil(height/40)"}, "labelOverlap": true}], "title": {"text": "C and gamma vs. Mean Test Score", "frame": "group"}, "width": 400, "legends": [{"fill": "color", "gradientLength": {"signal": "clamp(height, 64, 200)"}, "title": "mean_test_score", "encode": {"gradient": {"update": {"opacity": {"value": 0.7}}}}}], "height": 300, "padding": 5, "style": "cell", "background": "white"}, {"mode": "vega"});
</script></div></div>
</div>
</section>
</section>
<section id="discussions">
<h2>Discussions<a class="headerlink" href="#discussions" title="Permalink to this heading">#</a></h2>
<section id="key-findings">
<h3>Key Findings<a class="headerlink" href="#key-findings" title="Permalink to this heading">#</a></h3>
<p>In this bank marketing analysis project, we aimed to develop a binary classification model to predict client subscription to term deposits. We tested Logistic Regression and Support Vector Classifier (SVC) models, focusing on recall as a key performance metric. The SVC model outperformed Logistic Regression in recall, and after hyperparameter optimization, it achieved a recall score of 0.875 on the test dataset, which is quite promising!</p>
</section>
<section id="reflection-on-expectations">
<h3>Reflection on Expectations<a class="headerlink" href="#reflection-on-expectations" title="Permalink to this heading">#</a></h3>
<p>The results were somewhat expected, given SVC’s known efficacy in classification tasks, particularly when there’s a clear margin of separation. The high recall score of 0.875 indicates that the model is particularly adept at identifying clients likely to subscribe, which was the primary goal. It’s noteworthy that such a high recall was achieved, as it suggests the model is highly sensitive to true positive cases.</p>
</section>
<section id="impact-of-finding">
<h3>Impact of Finding<a class="headerlink" href="#impact-of-finding" title="Permalink to this heading">#</a></h3>
<p>The high recall score of this model has significant implications for targeted marketing strategies. It suggests that the bank can confidently use the model’s predictions to focus its marketing efforts on clients predicted to subscribe, potentially increasing the efficiency and effectiveness of its campaigns. This targeted approach could lead to higher conversion rates with lower marketing expenses. However, it’s important to balance such a high recall with precision to ensure that the bank doesn’t unnecessarily target unlikely prospects.</p>
</section>
<section id="future-improvements">
<h3>Future Improvements<a class="headerlink" href="#future-improvements" title="Permalink to this heading">#</a></h3>
<p>The success of this model leads to several potential areas for further exploration:</p>
<ul class="simple">
<li><p>Balancing Precision and Recall: Investigating methods to enhance precision without substantially reducing recall.</p></li>
<li><p>Feature Analysis: Identifying which features most significantly influence subscription predictions.
Model Interpretability: Improving the model’s interpretability to better understand the basis for its predictions.</p></li>
<li><p>Temporal Adaptability: Assessing the model’s adaptability to evolving trends and customer behaviors over time.</p></li>
<li><p>Testing Alternative Models: Exploring whether ensemble methods or more advanced machine learning algorithms could yield better or comparable results.</p></li>
<li><p>Customer Segmentation: Evaluating the model’s performance across different customer segments to tailor more specific marketing strategies.</p></li>
</ul>
</section>
</section>
<section id="references">
<h2>References<a class="headerlink" href="#references" title="Permalink to this heading">#</a></h2>
<div class="docutils container" id="id4">
<dl class="citation">
<dt class="label" id="id5"><span class="brackets">MRC12</span><span class="fn-backref">(<a href="#id1">1</a>,<a href="#id2">2</a>)</span></dt>
<dd><p>S. Moro, P. Rita, and P. Cortez. Bank marketing. UCI Machine Learning Repository, 2012. <a class="reference external" href="https://doi.org/10.24432/C5K306">https://doi.org/10.24432/C5K306</a>.</p>
</dd>
</dl>
</div>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer">
                  
<div class="prev-next-area">
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#summary">Summary</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#introduction">Introduction</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#background">Background</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#research-question">Research Question</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#methods">Methods</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#data">Data</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#analysis">Analysis</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#data-preprocessing">Data Preprocessing</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#model-selection-and-evaluation">Model Selection and Evaluation</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#model-comparison">Model Comparison</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#hyperparameter-optimization">Hyperparameter Optimization</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#recall-the-preferred-metric">Recall - The Preferred Metric</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#modeling-and-results">Modeling and Results</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exploratory-data-analysis">Exploratory Data Analysis</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#preprocessing">Preprocessing</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#model-selection">Model Selection</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id3">Hyperparameter Optimization</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#test-results-after-hyperparameter-optimization">Test results after hyperparameter optimization</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#discussions">Discussions</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#key-findings">Key Findings</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#reflection-on-expectations">Reflection on Expectations</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#impact-of-finding">Impact of Finding</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#future-improvements">Future Improvements</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#references">References</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Group 8: Runtian Li, Rafe Chang, Sid Grover, Anu Banga
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2022.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=5b4479735964841361fd"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=5b4479735964841361fd"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>